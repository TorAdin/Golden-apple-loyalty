# ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é BERT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ –º–æ–¥—É–ª—è
ls src/bert_loyalty.py

# –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ BERT –º–æ–¥–µ–ª–∏
ls Golden-apple-loyalty/models_binary_fixed_v2/
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- ‚úÖ `src/bert_loyalty.py` - –º–æ–¥—É–ª—å
- ‚úÖ `Golden-apple-loyalty/models_binary_fixed_v2/config.json` - –∫–æ–Ω—Ñ–∏–≥ –º–æ–¥–µ–ª–∏
- ‚úÖ `Golden-apple-loyalty/models_binary_fixed_v2/pytorch_model.bin` - –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏
- ‚úÖ `Golden-apple-loyalty/models_binary_fixed_v2/tokenizer_config.json` - —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä

### 2. –¢–µ—Å—Ç –º–æ–¥—É–ª—è –≤ standalone —Ä–µ–∂–∏–º–µ

```bash
python src/bert_loyalty.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
BERT Loyalty Analyzer - Test
============================================================
‚úÖ BERT –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞

–¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ 3 –æ—Ç–∑—ã–≤–∞—Ö...
–ó–∞–≥—Ä—É–∑–∫–∞ BERT –º–æ–¥–µ–ª–∏ –∏–∑ Golden-apple-loyalty/models_binary_fixed_v2...
‚úÖ BERT –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –Ω–∞ cpu
–ê–Ω–∞–ª–∏–∑ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ BERT –¥–ª—è 3 –æ—Ç–∑—ã–≤–æ–≤...
BERT –∞–Ω–∞–ª–∏–∑: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:01<00:00,  1.23s/batch]
‚úÖ BERT –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω
   –õ–æ—è–ª—å–Ω—ã—Ö (—Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä–æ–≥ ‚â•0.718): 1 (33.3%)
   –õ–æ—è–ª—å–Ω—ã—Ö (—Å—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ ‚â•0.55): 2 (66.7%)

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
  product_name  bert_loyalty_prob bert_loyalty_class
0    –ü—Ä–æ–¥—É–∫—Ç –ê              0.856              loyal
1    –ü—Ä–æ–¥—É–∫—Ç –ë              0.432          not_loyal
2    –ü—Ä–æ–¥—É–∫—Ç –í              0.123          not_loyal

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 0.470
  –õ–æ—è–ª—å–Ω—ã—Ö (—Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä–æ–≥): 1 (33.3%)
```

### 3. –¢–µ—Å—Ç –≤ Streamlit

```bash
streamlit run app.py
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

#### 3.1. –ü—Ä–æ–≤–µ—Ä—å sidebar
- ‚úÖ –ï—Å—Ç—å —Å–µ–∫—Ü–∏—è **"ü§ñ BERT –ê–Ω–∞–ª–∏–∑"**
- ‚úÖ –ï—Å—Ç—å —á–µ–∫–±–æ–∫—Å **"üß† –ó–∞–ø—É—Å—Ç–∏—Ç—å BERT –∞–Ω–∞–ª–∏–∑ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏"**

#### 3.2. –ê–∫—Ç–∏–≤–∏—Ä—É–π BERT –∞–Ω–∞–ª–∏–∑
1. –ü–æ—Å—Ç–∞–≤—å –≥–∞–ª–æ—á–∫—É –≤ —á–µ–∫–±–æ–∫—Å–µ
2. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Å–ø–∏–Ω–Ω–µ—Ä: **"üß† BERT –∞–Ω–∞–ª–∏–∑ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)..."**
3. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è: **"‚úÖ BERT –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω!"**

#### 3.3. –ü—Ä–æ–≤–µ—Ä—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É
- ‚úÖ –í —Å–ø–∏—Å–∫–µ –≤–∫–ª–∞–¥–æ–∫ –ø–æ—è–≤–∏–ª–∞—Å—å **"üß† BERT –ê–Ω–∞–ª–∏–∑"**
- ‚úÖ –í–∫–ª–∞–¥–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

#### 3.4. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ BERT –≤–∫–ª–∞–¥–∫–∏

**–°–µ–∫—Ü–∏—è 1: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
- ‚úÖ 4 –º–µ—Ç—Ä–∏–∫–∏: –í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤, –õ–æ—è–ª—å–Ω—ã—Ö (—Å—Ç—Ä–æ–≥–∏–π), –õ–æ—è–ª—å–Ω—ã—Ö (—Å—Ä–µ–¥–Ω–∏–π), –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Ä–∞–≤–Ω—ã 0
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (0-100%)

**–°–µ–∫—Ü–∏—è 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π**
- ‚úÖ –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π BERT –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ù–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ 3 –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (–ø–æ—Ä–æ–≥–∏)
- ‚úÖ Bar chart –≤–ª–∏—è–Ω–∏—è –ø–æ—Ä–æ–≥–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–°–µ–∫—Ü–∏—è 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å keyword –º–µ—Ç–æ–¥–æ–º**
- ‚úÖ Scatter plot –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ï—Å—Ç—å –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è (—Å–µ—Ä–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è)
- ‚úÖ –¢–æ—á–∫–∏ —Ä–∞—Å–∫—Ä–∞—à–µ–Ω—ã –ø–æ –∫–ª–∞—Å—Å—É (loyal/not_loyal)
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –î–∏—Å—Å–æ–Ω–∞–Ω—Å—ã (High Keyword / Low BERT –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–°–µ–∫—Ü–∏—è 4: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**
- ‚úÖ –°–ª–∞–π–¥–µ—Ä "–ú–∏–Ω–∏–º—É–º –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç" —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "üîÑ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏" –∫–ª–∏–∫–∞–µ—Ç—Å—è
- ‚úÖ –ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–ø–∏–Ω–Ω–µ—Ä
- ‚úÖ –ü–æ—Å–ª–µ —Ä–∞—Å—á—ë—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è: **"‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ X –ø—Ä–æ–¥—É–∫—Ç–æ–≤"**
- ‚úÖ 4 –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ "–¢–æ–ø-10" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ "–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫ "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ z-scores" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫ "Z-score vs –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (CSV)" —Ä–∞–±–æ—Ç–∞–µ—Ç

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤—ã–π workflow

```
1. –ó–∞–ø—É—Å—Ç–∏ app.py
2. –î–æ–∂–¥–∏—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π BERT –∞–Ω–∞–ª–∏–∑ (—á–µ–∫–±–æ–∫—Å –≤ sidebar)
4. –î–æ–∂–¥–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
5. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "üß† BERT –ê–Ω–∞–ª–∏–∑"
6. –ü—Ä–æ–∫—Ä—É—Ç–∏ –≤—Å–µ —Å–µ–∫—Ü–∏–∏ - –≤—Å–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```
1. –ó–∞–ø—É—Å—Ç–∏ BERT –∞–Ω–∞–ª–∏–∑ (–∫–∞–∫ –≤ –°—Ü–µ–Ω–∞—Ä–∏–∏ 1)
2. –í sidebar –≤—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞ (–Ω–µ "–í—Å–µ")
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤ BERT –≤–∫–ª–∞–¥–∫–µ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å
4. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç, BERT –º–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```
1. –ó–∞–ø—É—Å—Ç–∏ BERT –∞–Ω–∞–ª–∏–∑
2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "üß† BERT –ê–Ω–∞–ª–∏–∑"
3. –ü—Ä–æ–∫—Ä—É—Ç–∏ –¥–æ "üèÜ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤"
4. –ù–∞—Å—Ç—Ä–æ–π –º–∏–Ω–∏–º—É–º –æ—Ç–∑—ã–≤–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 50)
5. –ù–∞–∂–º–∏ "üîÑ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å"
6. –î–æ–∂–¥–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
7. –ü—Ä–æ–≤–µ—Ä—å –≤—Å–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
8. –°–∫–∞—á–∞–π CSV (–∫–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É)
9. –û—Ç–∫—Ä–æ–π CSV –∏ –ø—Ä–æ–≤–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –†–∞—Å—á—ë—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- CSV —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: product_name, total_reviews, loyalty_rate_high, z_score, bayesian_score, relative_category

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

```
1. –ó–∞–ø—É—Å—Ç–∏ –æ–±–∞ –∞–Ω–∞–ª–∏–∑–∞:
   - –í–∫–ª—é—á–∏ "Sentiment Analysis"
   - –í–∫–ª—é—á–∏ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å Loyalty Score"
   - –í–∫–ª—é—á–∏ "üß† –ó–∞–ø—É—Å—Ç–∏—Ç—å BERT –∞–Ω–∞–ª–∏–∑"
2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "üß† BERT –ê–Ω–∞–ª–∏–∑"
3. –ü—Ä–æ–∫—Ä—É—Ç–∏ –¥–æ "üî¨ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: BERT vs Keyword –º–µ—Ç–æ–¥"
4. –ü—Ä–æ–≤–µ—Ä—å scatter plot
5. –ü—Ä–æ–≤–µ—Ä—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 0.3-0.8)
6. –ü—Ä–æ–≤–µ—Ä—å –¥–∏—Å—Å–æ–Ω–∞–Ω—Å—ã
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** Scatter plot –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é, –µ—Å—Ç—å –¥–∏—Å—Å–æ–Ω–∞–Ω—Å—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```
1. –ó–∞–ø—É—Å—Ç–∏ BERT –∞–Ω–∞–ª–∏–∑ (–¥–æ–∂–¥–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)
2. –ò–∑–º–µ–Ω–∏ —Ñ–∏–ª—å—Ç—Ä (–≤—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é)
3. –í–µ—Ä–Ω–∏ —Ñ–∏–ª—å—Ç—Ä –æ–±—Ä–∞—Ç–Ω–æ (–≤—ã–±–µ—Ä–∏ "–í—Å–µ")
4. BERT –∞–Ω–∞–ª–∏–∑ –¥–æ–ª–∂–µ–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–∏–∑ –∫—ç—à–∞)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ session_state

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–∞–ª—ã–π –¥–∞—Ç–∞—Å–µ—Ç (~1000 –æ—Ç–∑—ã–≤–æ–≤)
- ‚úÖ BERT –∞–Ω–∞–ª–∏–∑: 10-30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑: 1-5 —Å–µ–∫—É–Ω–¥

### –°—Ä–µ–¥–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç (~10000 –æ—Ç–∑—ã–≤–æ–≤)
- ‚úÖ BERT –∞–Ω–∞–ª–∏–∑: 1-5 –º–∏–Ω—É—Ç
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑: 5-15 —Å–µ–∫—É–Ω–¥

### –ë–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç (~100000 –æ—Ç–∑—ã–≤–æ–≤)
- ‚úÖ BERT –∞–Ω–∞–ª–∏–∑: 10-30 –º–∏–Ω—É—Ç (CPU), 2-5 –º–∏–Ω—É—Ç (GPU)
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑: 30-60 —Å–µ–∫—É–Ω–¥

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫

### BERT –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
```python
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
0 <= bert_loyalty_prob <= 1
```

### Z-score
```python
# –û–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ:
-3 <= z_score <= 3

# –†–µ–¥–∫–æ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
```

### –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –±–∞–ª–ª
```python
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–ª–∏–∑–æ–∫ –∫ loyalty_rate_high, –Ω–æ —Å–≥–ª–∞–∂–µ–Ω:
0 <= bayesian_score <= 1

# –î–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤:
bayesian_score < loyalty_rate_high (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –∫ —Å—Ä–µ–¥–Ω–µ–º—É)

# –î–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤:
bayesian_score ‚âà loyalty_rate_high
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- üöÄ –í—ã–¥–∞—é—â–∏–π—Å—è (z > 2)
- üìà –í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ (1 <= z < 2)
- üìä –°—Ä–µ–¥–Ω–∏–π (-1 <= z < 1)
- ‚ö†Ô∏è –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ (-2 <= z < -1)
- üî• –ü—Ä–æ–±–ª–µ–º–Ω—ã–π (z < -2)

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω

### BERT –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–û—à–∏–±–∫–∞:**
```
‚ùå BERT –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –ø—É—Ç—å: `Golden-apple-loyalty/models_binary_fixed_v2/`
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ —Ç–∞–º –µ—Å—Ç—å —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–∏
3. –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `ls -la Golden-apple-loyalty/models_binary_fixed_v2/`

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ

**–û—à–∏–±–∫–∞:**
```
RuntimeError: Expected all tensors to be on the same device
```

**–†–µ—à–µ–Ω–∏–µ:**
–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏ PyTorch:
```bash
pip uninstall torch
pip install torch
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

**–†–µ—à–µ–Ω–∏–µ 1:** –£–º–µ–Ω—å—à–∏ batch_size
```python
# –í src/bert_loyalty.py
probabilities = self.predict_batch(texts, batch_size=16)  # –ë—ã–ª–æ 32
```

**–†–µ—à–µ–Ω–∏–µ 2:** –ü—Ä–æ–≤–µ—Ä—å GPU
```python
import torch
print(torch.cuda.is_available())  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å True –µ—Å–ª–∏ –µ—Å—Ç—å GPU
```

### –û—à–∏–±–∫–∞ –ø–∞–º—è—Ç–∏ (OOM)

**–û—à–∏–±–∫–∞:**
```
RuntimeError: CUDA out of memory
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ CPU
CUDA_VISIBLE_DEVICES="" streamlit run app.py
```

### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è (<0.2)

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** BERT –∏ keyword –º–µ—Ç–æ–¥—ã –∏–∑–º–µ—Ä—è—é—Ç —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:
- Keyword: –æ–±—â–∞—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- BERT: –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–∫—É–ø–∫–∏

–ù–∏–∑–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å —á—Ç–æ –º–µ—Ç–æ–¥—ã –¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

## –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ —É–±–µ–¥–∏—Å—å:

- ‚úÖ BERT –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ CSV —ç–∫—Å–ø–æ—Ä—Ç –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞

**–ï—Å–ª–∏ –≤—Å–µ ‚úÖ - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! üéâ**

## Troubleshooting FAQ

### Q: "No module named 'transformers'"
**A:** `pip install transformers`

### Q: "No module named 'torch'"
**A:** `pip install torch`

### Q: BERT –∞–Ω–∞–ª–∏–∑ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π
**A:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è CPU. –ò—Å–ø–æ–ª—å–∑—É–π GPU –∏–ª–∏ —É–º–µ–Ω—å—à–∏ batch_size.

### Q: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã BERT –∏ keyword —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è
**A:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –û–Ω–∏ –∏–∑–º–µ—Ä—è—é—Ç —Ä–∞–∑–Ω—ã–µ –≤–µ—â–∏. –°–º–æ—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª "–î–∏—Å—Å–æ–Ω–∞–Ω—Å—ã".

### Q: Z-score –Ω–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
**A:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤.

### Q: Streamlit –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ BERT –∞–Ω–∞–ª–∏–∑–µ
**A:** –£–≤–µ–ª–∏—á—å –ª–∏–º–∏—Ç –ø–∞–º—è—Ç–∏: `streamlit run app.py --server.maxUploadSize=1000`

---

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üöÄ**

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å:
1. [QUICK_START.md](QUICK_START.md) - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
2. [BERT_INTEGRATION.md](BERT_INTEGRATION.md) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
3. [CHANGELOG_BERT.md](CHANGELOG_BERT.md) - —á—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ
