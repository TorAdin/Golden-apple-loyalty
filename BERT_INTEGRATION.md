# üß† BERT Integration - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–í –ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ **BERT –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏**, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ 600 —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é –æ—Ç–∑—ã–≤–∞—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

1. **BERT-based –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏**
   - –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: –ª–æ—è–ª—å–Ω—ã–π / –Ω–µ–ª–æ—è–ª—å–Ω—ã–π
   - –¢—Ä–∏ –ø–æ—Ä–æ–≥–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: —Å—Ç—Ä–æ–≥–∏–π (0.718), —Å—Ä–µ–¥–Ω–∏–π (0.55), –º—è–≥–∫–∏–π (0.40)
   - –ü—Å–µ–≤–¥–æ–ª–µ–π–±–ª–∏–Ω–≥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞

2. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å keyword –º–µ—Ç–æ–¥–æ–º**
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É BERT –∏ keyword –º–µ—Ç–æ–¥–∞–º–∏
   - –í—ã—è–≤–ª–µ–Ω–∏–µ –¥–∏—Å—Å–æ–Ω–∞–Ω—Å–æ–≤ (high keyword / low BERT –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

3. **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–∫–∞–∫ —É –¥—Ä—É–≥–∞)**
   - Z-score –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
   - –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –±–∞–ª–ª (–∫–∞–∫ –Ω–∞ IMDb)
   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è: –í—ã–¥–∞—é—â–∏–π—Å—è, –í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –°—Ä–µ–¥–Ω–∏–π, –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –ü—Ä–æ–±–ª–µ–º–Ω—ã–π
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
GoldenApple/
‚îú‚îÄ‚îÄ app.py                          # –û–±–Ω–æ–≤–ª—ë–Ω: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ "üß† BERT –ê–Ω–∞–ª–∏–∑"
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ bert_loyalty.py            # –ù–û–í–´–ô: –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å BERT –º–æ–¥–µ–ª—å—é
‚îú‚îÄ‚îÄ Golden-apple-loyalty/          # –ü–∞–ø–∫–∞ —Å –∫–æ–¥–æ–º –¥—Ä—É–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ models_binary_fixed_v2/    # BERT –º–æ–¥–µ–ª—å (—Ç—Ä–µ–±—É–µ—Ç—Å—è!)
‚îÇ   ‚îú‚îÄ‚îÄ train_bert_gpu.py          # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ hybrid.py                  # –ì–∏–±—Ä–∏–¥–Ω–∞—è –º–æ–¥–µ–ª—å (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ business_report.py         # –û—Ç—á—ë—Ç (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ main.py                    # Main —Å–∫—Ä–∏–ø—Ç –¥—Ä—É–≥–∞ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
‚îî‚îÄ‚îÄ BERT_INTEGRATION.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–æ–¥–µ–ª–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ BERT –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏:
```
Golden-apple-loyalty/models_binary_fixed_v2/
```

–í —ç—Ç–æ–π –ø–∞–ø–∫–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã:
- `config.json`
- `pytorch_model.bin` (–∏–ª–∏ `model.safetensors`)
- `tokenizer_config.json`
- –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞

### 2. –ó–∞–ø—É—Å–∫ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
streamlit run app.py
```

### 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è BERT –∞–Ω–∞–ª–∏–∑–∞

–í –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é (sidebar):
1. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ —Å–µ–∫—Ü–∏–∏ **"ü§ñ BERT –ê–Ω–∞–ª–∏–∑"**
2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É **"üß† –ó–∞–ø—É—Å—Ç–∏—Ç—å BERT –∞–Ω–∞–ª–∏–∑ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏"**
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö)

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ "üß† BERT –ê–Ω–∞–ª–∏–∑"

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—è–≤–∏—Ç—Å—è –Ω–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏:

#### üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ BERT –∞–Ω–∞–ª–∏–∑–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ—è–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –ø–æ—Ä–æ–≥–∞–º
- –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π

#### üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: BERT vs Keyword –º–µ—Ç–æ–¥
- Scatter plot: –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏
- –î–∏—Å—Å–æ–Ω–∞–Ω—Å—ã (—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏)
- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### üèÜ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (z-score)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç
- –†–∞—Å—á—ë—Ç z-score –∏ –±–∞–π–µ—Å–æ–≤—Å–∫–∏—Ö –±–∞–ª–ª–æ–≤
- –¢–æ–ø-10 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è z-scores
- –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CSV

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ú–æ–¥—É–ª—å `bert_loyalty.py`

```python
from src.bert_loyalty import BertLoyaltyAnalyzer

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
analyzer = BertLoyaltyAnalyzer(
    model_path="Golden-apple-loyalty/models_binary_fixed_v2",
    threshold=0.718  # –ü–æ—Ä–æ–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
)

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
analyzer.load_model()

# –ê–Ω–∞–ª–∏–∑ DataFrame
df_result = analyzer.analyze_dataframe(df)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏:
# - bert_loyalty_prob: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ [0, 1]
# - bert_loyalty_high: –ª–æ—è–ª—å–Ω—ã–π –ø–æ —Å—Ç—Ä–æ–≥–æ–º—É –ø–æ—Ä–æ–≥—É
# - bert_loyalty_medium: –ª–æ—è–ª—å–Ω—ã–π –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –ø–æ—Ä–æ–≥—É
# - bert_loyalty_low: –ª–æ—è–ª—å–Ω—ã–π –ø–æ –º—è–≥–∫–æ–º—É –ø–æ—Ä–æ–≥—É
# - bert_loyalty_class: 'loyal' –∏–ª–∏ 'not_loyal'
```

### –†–∞—Å—á—ë—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π

```python
# –†–∞—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º —Å z-score
product_stats = analyzer.calculate_product_stats(
    df,
    min_reviews=100  # –ú–∏–Ω–∏–º—É–º –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
# - total_reviews: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
# - loyalty_rate_high: –¥–æ–ª—è –ª–æ—è–ª—å–Ω—ã—Ö
# - z_score: –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ)
# - bayesian_score: –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –±–∞–ª–ª (–∫–∞–∫ –Ω–∞ IMDb)
# - percentile_rank: –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å
# - relative_category: –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–í—ã–¥–∞—é—â–∏–π—Å—è, –í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –∏ —Ç.–¥.)
```

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### Z-score
- **z > 2**: –í—ã–¥–∞—é—â–∏–π—Å—è –ø—Ä–æ–¥—É–∫—Ç (–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)
- **z ‚â• 1**: –í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
- **-1 < z < 1**: –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
- **z ‚â§ -1**: –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
- **z < -2**: –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç (–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)

### BERT –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
- **‚â• 0.718**: –õ–æ—è–ª—å–Ω—ã–π (—Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä–æ–≥, –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
- **‚â• 0.55**: –õ–æ—è–ª—å–Ω—ã–π (—Å—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥, –±–∞–ª–∞–Ω—Å)
- **‚â• 0.40**: –õ–æ—è–ª—å–Ω—ã–π (–º—è–≥–∫–∏–π –ø–æ—Ä–æ–≥, –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π)

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å keyword –º–µ—Ç–æ–¥–æ–º
- **–í—ã—Å–æ–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (> 0.7)**: –ú–µ—Ç–æ–¥—ã —Å–æ–≥–ª–∞—Å–Ω—ã
- **–°—Ä–µ–¥–Ω—è—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (0.4-0.7)**: –ú–µ—Ç–æ–¥—ã —á–∞—Å—Ç–∏—á–Ω–æ —Å–æ–≥–ª–∞—Å–Ω—ã
- **–ù–∏–∑–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (< 0.4)**: –ú–µ—Ç–æ–¥—ã —Ä–∞—Å—Ö–æ–¥—è—Ç—Å—è

**–î–∏—Å—Å–æ–Ω–∞–Ω—Å—ã** (—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏) –º–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞:
- –°–ª–æ–∂–Ω—ã–µ –æ—Ç–∑—ã–≤—ã, –≥–¥–µ keyword –º–µ—Ç–æ–¥ –Ω–µ—Ç–æ—á–µ–Ω
- –°–∞—Ä–∫–∞–∑–º –∏–ª–∏ —Å–∫—Ä—ã—Ç–æ–µ –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ
- –ù—é–∞–Ω—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ BERT –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–µ—Ç

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞
- **CPU**: ~50-100 –æ—Ç–∑—ã–≤–æ–≤/—Å–µ–∫
- **GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)**: ~500-1000 –æ—Ç–∑—ã–≤–æ–≤/—Å–µ–∫

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (>50k –æ—Ç–∑—ã–≤–æ–≤) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU
- –í –æ–±–ª–∞—á–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (Streamlit Cloud) BERT –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ session_state –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤

## –û—Ç–ª–∏—á–∏—è –æ—Ç –∫–æ–¥–∞ –¥—Ä—É–≥–∞

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:
- ‚úÖ BERT –º–æ–¥–µ–ª—å (`models_binary_fixed_v2`)
- ‚úÖ –¢—Ä–∏ –ø–æ—Ä–æ–≥–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (0.718, 0.55, 0.40)
- ‚úÖ Z-score —Ä–∞—Å—á—ë—Ç –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
- ‚úÖ –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –±–∞–ª–ª
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Streamlit –≤–º–µ—Å—Ç–æ standalone —Å–∫—Ä–∏–ø—Ç–æ–≤
- üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ session_state
- üîÑ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (plotly)
- üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å keyword –º–µ—Ç–æ–¥–æ–º
- üîÑ –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π API –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ß—Ç–æ –ù–ï –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ:
- ‚ùå Random Forest –ø–æ–≤–µ—Ä—Ö BERT (hybrid.py) - –Ω–µ –Ω—É–∂–µ–Ω
- ‚ùå –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (train_bert_gpu.py) - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é
- ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á—ë—Ç–æ–≤ (business_report.py) - –µ—Å—Ç—å CSV —ç–∫—Å–ø–æ—Ä—Ç

## Troubleshooting

### –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
```
‚ùå BERT –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å: `Golden-apple-loyalty/models_binary_fixed_v2/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```
üß† BERT –∞–Ω–∞–ª–∏–∑ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)...
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è)
2. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `torch` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π GPU

### –û—à–∏–±–∫–∞ –ø–∞–º—è—Ç–∏ (OOM)
```
RuntimeError: CUDA out of memory
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –≤ `analyze_dataframe()` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 32)
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ CPU: `CUDA_VISIBLE_DEVICES="" streamlit run app.py`
3. –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç—è–º–∏

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤** - –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ
2. **–ê–Ω—Å–∞–º–±–ª—å –º–µ—Ç–æ–¥–æ–≤** - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è BERT + keyword –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
3. **–û–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π** - –ø–æ—á–µ–º—É BERT —Å—á–∏—Ç–∞–µ—Ç –æ—Ç–∑—ã–≤ –ª–æ—è–ª—å–Ω—ã–º
4. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
5. **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏** - –Ω–∞ –Ω–æ–≤—ã—Ö —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞—à–µ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–í–æ–ø—Ä–æ—Å—ã –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: —Å–º–æ—Ç—Ä–∏ –∫–æ–¥ –≤ `src/bert_loyalty.py`
–í–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–¥–µ–ª–∏: —Å–º–æ—Ç—Ä–∏ –∫–æ–¥ –¥—Ä—É–≥–∞ –≤ `Golden-apple-loyalty/`
